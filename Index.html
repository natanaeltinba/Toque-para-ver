<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Toque para ver</title>
</head>
<body>
  <h1>Olá! A página está funcionando.</h1>
  <p>Seu site GitHub Pages está ativo.</p>
</body>
</html>
<!-- Leaflet (mapa) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-sA+e2H0f5Qb+5YV7V0lyY2UqGkQmYv1w+3Zr7gX0C/4=" crossorigin=""/>
  <style>
    :root{
      --bg:#08080b;
      --accent:#00ffb7;
      --card:#0f1720;
      --muted:#9aa0a6;
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      background: linear-gradient(180deg,#000 0%, #07070a 100%);
      color: #fff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .app{
      width:100%;
      max-width:520px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      box-shadow: 0 6px 30px rgba(0,0,0,0.6);
      padding:20px;
      box-sizing:border-box;
    }
    h1{margin:0 0 12px;font-size:1.6rem;color:var(--accent);letter-spacing:0.5px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    button.primary{
      background:linear-gradient(135deg,var(--accent),#0096ff);
      color:#001;
      border:none;
      padding:12px 18px;
      border-radius:10px;
      font-weight:700;
      font-size:16px;
      cursor:pointer;
      box-shadow: 0 6px 14px rgba(0,0,0,0.45);
    }
    .meta{margin-top:12px;color:var(--muted);font-size:13px}
    #result{margin-top:16px;background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;color:#fff}
    #map{height:320px;border-radius:10px;margin-top:12px;border:1px solid rgba(255,255,255,0.04)}
    small.note{display:block;margin-top:8px;color:var(--muted);font-size:12px}
    footer{margin-top:14px;color:var(--muted);font-size:12px;text-align:center}
    .center{display:flex;gap:8px;align-items:center}
  </style>
</head>
<body>
  <div class="app" role="main">
    <h1>Toque para ver</h1>
    <p class="lead">Ao tocar em <strong>Visualizar</strong> você verá sua localização atual no mapa. Isso requer permissão do dispositivo.</p>

    <div class="center">
      <button class="primary" id="btn">Visualizar</button>
      <div class="meta" id="status">Pronto</div>
    </div>

    <div id="result" style="display:none;">
      <div><strong>Coordenadas:</strong> <span id="coords"></span></div>
      <div><strong>Hora:</strong> <span id="hora"></span></div>
      <div id="map"></div>
      <small class="note">A localização é mostrada somente neste dispositivo e NÃO é enviada a nenhum servidor.</small>
    </div>

    <footer>
      Dica: para instalar na tela inicial do celular, abra o menu do navegador e escolha "Adicionar à tela inicial".
    </footer>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-o9N1j6w3qtr2kGk1Qf2xQf8a2e4wZ1b8b6i0u5wXk2s=" crossorigin=""></script>

  <script>
    const btn = document.getElementById('btn');
    const statusElm = document.getElementById('status');
    const result = document.getElementById('result');
    const coordsElm = document.getElementById('coords');
    const horaElm = document.getElementById('hora');

    let map, marker;

    btn.addEventListener('click', async () => {
      // Confirmação explícita
      const ok = confirm("Ao abrir, você concorda em permitir que este site ACESSE sua localização atual para mostrar no mapa. Deseja continuar?");
      if (!ok) {
        statusElm.textContent = 'Cancelado pelo usuário';
        return;
      }

      if (!('geolocation' in navigator)) {
        alert('Seu navegador não suporta Geolocalização.');
        statusElm.textContent = 'Geolocalização não suportada';
        return;
      }

      statusElm.textContent = 'Solicitando permissão...';

      navigator.geolocation.getCurrentPosition(success, error, {
        enableHighAccuracy: true,
        timeout: 15000,
        maximumAge: 0
      });
    });

    function success(position) {
      const lat = position.coords.latitude.toFixed(6);
      const lon = position.coords.longitude.toFixed(6);
      const ts = new Date(position.timestamp);
      const tsStr = ts.toLocaleString();

      coordsElm.textContent = `${lat}, ${lon}`;
      horaElm.textContent = tsStr;
      statusElm.textContent = 'Localização obtida';

      result.style.display = 'block';

      // Inicializa mapa Leaflet na primeira vez
      if (!map) {
        map = L.map('map', { zoomControl: true }).setView([lat, lon], 15);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
          attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
        marker = L.marker([lat, lon]).addTo(map).bindPopup('Você está aqui').openPopup();
      } else {
        marker.setLatLng([lat, lon]).update();
        map.setView([lat, lon], 15);
      }
    }

    function error(err) {
      console.error(err);
      if (err.code === 1) {
        statusElm.textContent = 'Permissão negada';
        alert('Permissão de localização negada. Para funcionar, permita no navegador.');
      } else if (err.code === 2) {
        statusElm.textContent = 'Posição indisponível';
        alert('Não foi possível obter a posição do dispositivo.');
      } else if (err.code === 3) {
        statusElm.textContent = 'Tempo esgotado';
        alert('Tempo esgotado ao tentar obter localização. Tente novamente.');
      } else {
        statusElm.textContent = 'Erro desconhecido';
        alert('Erro ao obter localização: ' + (err.message || 'desconhecido'));
      }
    }
  </script>
</body>
</html>
